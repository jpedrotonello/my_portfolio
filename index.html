<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>João Pedro Tonello - AI Engineer / Data Scientist</title>
  <meta name="description" content="Portfolio of João Pedro Tonello — AI Engineer and Data Scientist based in São Paulo, Brazil." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <!-- marked.js for Markdown rendering in chat -->
  <script src="https://cdn.jsdelivr.net/npm/marked@9/marked.min.js"></script>
  <style>
    /* ── Reset & Base ──────────────────────────────────────────────── */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Inter', sans-serif;
      font-size: 15px;
      line-height: 1.6;
      transition: background 0.2s, color 0.2s;
    }

    /* ── CSS Variables — Light (default) ───────────────────────────── */
    :root {
      --bg:         #f5f6fa;
      --bg-card:    #ffffff;
      --fg:         #1a1d2e;
      --fg-muted:   #6b7280;
      --border:     #e5e7eb;
      --primary:    #2563eb;
      --primary-fg: #ffffff;
      --muted-bg:   #f3f4f6;
      --badge-bg:   #e8edf8;
      --badge-fg:   #1e40af;
      --header-bg:  rgba(245,246,250,0.95);
      --shadow:     0 1px 3px rgba(0,0,0,0.08);
      --shadow-lg:  0 8px 30px rgba(0,0,0,0.12);
    }

    /* ── CSS Variables — Dark ───────────────────────────────────────── */
    body.dark {
      --bg:         #0f1117;
      --bg-card:    #1a1d2e;
      --fg:         #e2e8f0;
      --fg-muted:   #94a3b8;
      --border:     rgba(255,255,255,0.1);
      --primary:    #3b82f6;
      --primary-fg: #ffffff;
      --muted-bg:   #1e2235;
      --badge-bg:   #1e3a5f;
      --badge-fg:   #93c5fd;
      --header-bg:  rgba(15,17,23,0.95);
      --shadow:     0 1px 3px rgba(0,0,0,0.3);
      --shadow-lg:  0 8px 30px rgba(0,0,0,0.4);
    }

    body { background: var(--bg); color: var(--fg); }

    /* ── Layout ─────────────────────────────────────────────────────── */
    .container { max-width: 860px; margin: 0 auto; padding: 0 1.25rem; }

    /* ── Header ─────────────────────────────────────────────────────── */
    header {
      position: sticky; top: 0; z-index: 40;
      background: var(--header-bg);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .header-inner {
      display: flex; align-items: center; justify-content: space-between;
      height: 60px; gap: 1rem;
    }
    .header-profile { display: flex; align-items: center; gap: 0.75rem; min-width: 0; }
    .header-avatar {
      width: 38px; height: 38px; border-radius: 50%;
      overflow: hidden; border: 2px solid var(--primary);
      flex-shrink: 0;
    }
    .header-avatar img { width: 100%; height: 100%; object-fit: cover; }
    .header-name { font-weight: 600; font-size: 0.875rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .header-title { font-size: 0.75rem; color: var(--fg-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    @media (max-width: 500px) { .header-text { display: none; } }

    .header-nav { display: flex; align-items: center; gap: 0.375rem; flex-shrink: 0; }
    .btn {
      display: inline-flex; align-items: center; gap: 0.375rem;
      padding: 0.375rem 0.875rem; border-radius: 8px;
      font-size: 0.8125rem; font-weight: 500; cursor: pointer;
      border: 1px solid transparent; transition: all 0.15s; text-decoration: none;
      background: none; color: var(--fg);
    }
    .btn:hover { background: var(--muted-bg); }
    .btn.active { background: var(--primary); color: var(--primary-fg); border-color: var(--primary); }
    .btn-outline {
      border-color: color-mix(in srgb, var(--primary) 40%, transparent);
      color: var(--primary);
    }
    .btn-outline:hover { background: color-mix(in srgb, var(--primary) 10%, transparent); }
    .btn-ghost { color: var(--fg-muted); }
    .btn-ghost:hover { color: var(--fg); background: var(--muted-bg); }
    @media (max-width: 700px) { .btn-ask-header { display: none !important; } }

    /* ── Main ───────────────────────────────────────────────────────── */
    main { padding: 2rem 0 3rem; }

    /* ── Hero ───────────────────────────────────────────────────────── */
    .hero {
      display: flex; align-items: center; gap: 1.5rem;
      padding-bottom: 1.75rem; margin-bottom: 1.75rem;
      border-bottom: 1px solid var(--border);
    }
    .hero-avatar {
      width: 88px; height: 88px; border-radius: 16px;
      overflow: hidden; border: 2px solid color-mix(in srgb, var(--primary) 30%, transparent);
      flex-shrink: 0;
    }
    .hero-avatar img { width: 100%; height: 100%; object-fit: cover; }
    .hero h1 { font-size: 1.75rem; font-weight: 700; margin-bottom: 0.25rem; }
    .hero-title { font-size: 1rem; color: var(--primary); font-weight: 500; margin-bottom: 0.625rem; }
    .hero-meta { display: flex; flex-wrap: wrap; gap: 0.875rem; font-size: 0.8125rem; color: var(--fg-muted); }
    .hero-meta a { color: var(--primary); text-decoration: none; display: flex; align-items: center; gap: 0.3rem; }
    .hero-meta a:hover { text-decoration: underline; }
    @media (max-width: 500px) {
      .hero { flex-direction: column; align-items: flex-start; }
      .hero h1 { font-size: 1.4rem; }
    }

    /* ── Card ───────────────────────────────────────────────────────── */
    .card {
      background: var(--bg-card); border: 1px solid var(--border);
      border-radius: 12px; overflow: hidden;
      transition: border-color 0.15s; box-shadow: var(--shadow);
    }
    .card:hover { border-color: color-mix(in srgb, var(--primary) 40%, transparent); }

    /* ── Dropdown Card ──────────────────────────────────────────────── */
    .dropdown-card { margin-bottom: 0.625rem; }
    .dropdown-trigger {
      width: 100%; text-align: left; background: none; border: none; cursor: pointer;
      padding: 1.125rem 1.25rem; display: flex; align-items: flex-start;
      justify-content: space-between; gap: 1rem; color: var(--fg);
    }
    .dropdown-trigger:hover .dropdown-title { color: var(--primary); }
    .dropdown-title { font-weight: 600; font-size: 0.9375rem; margin-bottom: 0.375rem; transition: color 0.15s; }
    .dropdown-summary { font-size: 0.8125rem; color: var(--fg-muted); line-height: 1.6; }
    .dropdown-chevron { flex-shrink: 0; margin-top: 2px; color: var(--fg-muted); transition: transform 0.2s; }
    .dropdown-chevron.open { transform: rotate(180deg); }
    .dropdown-body {
      padding: 1rem 1.25rem 1.25rem;
      border-top: 1px solid var(--border);
      display: none;
    }
    .dropdown-body.open { display: block; }
    .detail-section { margin-bottom: 1rem; }
    .detail-section:last-child { margin-bottom: 0; }
    .detail-label {
      font-size: 0.6875rem; font-weight: 600;
      letter-spacing: 0.04em; color: var(--primary); margin-bottom: 0.375rem;
    }
    .detail-text { font-size: 0.8125rem; color: var(--fg-muted); line-height: 1.65; }

    /* ── Section ────────────────────────────────────────────────────── */
    .section { margin-bottom: 2rem; }
    .section-title { font-size: 1.0625rem; font-weight: 600; margin-bottom: 1rem; }

    /* ── About Card ─────────────────────────────────────────────────── */
    .about-card { padding: 1.25rem; margin-bottom: 1.75rem; }
    .about-card p { font-size: 0.875rem; color: var(--fg-muted); line-height: 1.7; margin-bottom: 1rem; }
    .about-bullets { list-style: none; }
    .about-bullets li {
      display: flex; gap: 0.5rem; font-size: 0.8125rem;
      color: var(--fg-muted); margin-bottom: 0.375rem; line-height: 1.6;
    }
    .about-bullets li::before { content: "▸"; color: var(--primary); flex-shrink: 0; margin-top: 1px; }

    /* ── Badges ─────────────────────────────────────────────────────── */
    .badges { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.875rem; }
    .badge {
      background: var(--badge-bg); color: var(--badge-fg);
      padding: 0.25rem 0.625rem; border-radius: 6px;
      font-size: 0.75rem; font-weight: 500;
    }

    /* ── Resume Card ────────────────────────────────────────────────── */
    .resume-company { font-size: 0.875rem; font-weight: 500; color: var(--primary); }
    .resume-period {
      display: inline-block; font-size: 0.75rem; color: var(--fg-muted);
      background: var(--muted-bg); padding: 0.125rem 0.5rem;
      border-radius: 20px; margin-left: 0.5rem;
    }
    .resume-details { list-style: none; }
    .resume-details li {
      display: flex; gap: 0.5rem; font-size: 0.8125rem;
      color: var(--fg-muted); margin-bottom: 0.375rem; line-height: 1.6;
    }
    .resume-details li::before { content: "▸"; color: var(--primary); flex-shrink: 0; margin-top: 1px; }

    /* ── Achievement Card ───────────────────────────────────────────── */
    .achievement-star { color: var(--primary); font-size: 0.75rem; margin-right: 0.375rem; }

    /* ── Education ──────────────────────────────────────────────────── */
    .edu-list { display: flex; flex-direction: column; gap: 0.875rem; }
    .edu-item { display: flex; align-items: flex-start; justify-content: space-between; gap: 1rem; }
    .edu-degree { font-size: 0.875rem; font-weight: 500; }
    .edu-inst { font-size: 0.8125rem; color: var(--fg-muted); margin-top: 0.125rem; }
    .edu-year { font-size: 0.8125rem; color: var(--fg-muted); flex-shrink: 0; }

    /* ── Footer ─────────────────────────────────────────────────────── */
    footer {
      border-top: 1px solid var(--border);
      padding: 1.5rem 0;
      font-size: 0.8125rem; color: var(--fg-muted);
    }
    .footer-inner {
      display: flex; flex-wrap: wrap; align-items: center;
      justify-content: space-between; gap: 0.75rem;
    }
    .footer-links { display: flex; align-items: center; gap: 1rem; }
    .footer-links a { color: var(--primary); text-decoration: none; display: flex; align-items: center; gap: 0.3rem; }
    .footer-links a:hover { text-decoration: underline; }

    /* ── Chat Widget ────────────────────────────────────────────────── */
    #chat-panel {
      position: fixed; bottom: 5.5rem; right: 1.25rem; z-index: 50;
      width: min(360px, calc(100vw - 2rem));
      max-height: min(520px, calc(100vh - 140px));
      background: var(--bg-card); border: 1px solid var(--border);
      border-radius: 16px; box-shadow: var(--shadow-lg);
      display: flex; flex-direction: column; overflow: hidden;
      animation: slideUp 0.2s ease;
    }
    #chat-panel.hidden { display: none; }
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(12px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .chat-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.75rem 1rem; border-bottom: 1px solid var(--border);
      background: color-mix(in srgb, var(--primary) 5%, transparent);
    }
    .chat-header-info { display: flex; align-items: center; gap: 0.625rem; }
    .chat-avatar {
      width: 34px; height: 34px; border-radius: 50%;
      overflow: hidden; border: 2px solid color-mix(in srgb, var(--primary) 40%, transparent);
      flex-shrink: 0;
    }
    .chat-avatar img { width: 100%; height: 100%; object-fit: cover; }
    .chat-header-name { font-size: 0.875rem; font-weight: 600; }
    .chat-header-sub { font-size: 0.75rem; color: var(--fg-muted); }
    .chat-close {
      background: none; border: none; cursor: pointer; color: var(--fg-muted);
      padding: 0.25rem; border-radius: 50%; transition: background 0.15s;
    }
    .chat-close:hover { background: var(--muted-bg); color: var(--fg); }

    .chat-messages {
      flex: 1; overflow-y: auto; padding: 1rem;
      display: flex; flex-direction: column; gap: 0.75rem;
      min-height: 0;
    }
    .chat-msg { display: flex; gap: 0.5rem; }
    .chat-msg.user { flex-direction: row-reverse; }
    .chat-msg-avatar {
      width: 28px; height: 28px; border-radius: 50%; flex-shrink: 0;
      overflow: hidden; border: 1px solid var(--border); margin-top: 2px;
    }
    .chat-msg-avatar img { width: 100%; height: 100%; object-fit: cover; }
    .chat-msg-avatar.user-icon {
      background: var(--muted-bg); display: flex; align-items: center; justify-content: center;
      font-size: 0.75rem; color: var(--fg-muted);
    }
    .chat-bubble {
      max-width: 80%; padding: 0.5rem 0.75rem; border-radius: 14px;
      font-size: 0.8125rem; line-height: 1.55;
    }
    .chat-bubble.assistant {
      background: var(--muted-bg); color: var(--fg);
      border-top-left-radius: 4px;
    }
    .chat-bubble.user {
      background: var(--primary); color: var(--primary-fg);
      border-top-right-radius: 4px;
    }
    /* Markdown inside chat bubbles */
    .chat-bubble.assistant p { margin-bottom: 0.4rem; }
    .chat-bubble.assistant p:last-child { margin-bottom: 0; }
    .chat-bubble.assistant ul, .chat-bubble.assistant ol { padding-left: 1.2rem; margin-bottom: 0.4rem; }
    .chat-bubble.assistant li { margin-bottom: 0.2rem; }
    .chat-bubble.assistant strong { font-weight: 600; }
    .chat-bubble.assistant h1, .chat-bubble.assistant h2, .chat-bubble.assistant h3 {
      font-size: 0.875rem; font-weight: 600; margin-bottom: 0.3rem;
    }

    .chat-suggestions { display: flex; flex-direction: column; gap: 0.375rem; padding-top: 0.25rem; }
    .chat-suggestion {
      background: var(--bg); border: 1px solid var(--border); border-radius: 10px;
      padding: 0.5rem 0.75rem; font-size: 0.75rem; color: var(--fg-muted);
      cursor: pointer; text-align: left; transition: all 0.15s;
    }
    .chat-suggestion:hover { border-color: var(--primary); color: var(--fg); background: var(--muted-bg); }
    .chat-suggestions-label { font-size: 0.75rem; color: var(--fg-muted); margin-bottom: 0.25rem; }

    .chat-loading { display: flex; gap: 4px; align-items: center; padding: 0.5rem 0.75rem; }
    .chat-loading span {
      width: 6px; height: 6px; border-radius: 50%; background: var(--fg-muted);
      animation: bounce 1.2s infinite;
    }
    .chat-loading span:nth-child(2) { animation-delay: 0.2s; }
    .chat-loading span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes bounce {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-5px); }
    }

    .chat-input-area {
      padding: 0.75rem; border-top: 1px solid var(--border);
      display: flex; gap: 0.5rem; align-items: center;
    }
    #chat-input {
      flex: 1; background: var(--muted-bg); border: 1px solid var(--border);
      border-radius: 10px; padding: 0.5rem 0.75rem; font-size: 0.8125rem;
      color: var(--fg); outline: none; font-family: inherit;
      transition: border-color 0.15s;
    }
    #chat-input:focus { border-color: var(--primary); }
    #chat-input::placeholder { color: var(--fg-muted); }
    #chat-send {
      background: var(--primary); color: var(--primary-fg); border: none;
      border-radius: 10px; width: 36px; height: 36px; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0; transition: opacity 0.15s;
    }
    #chat-send:disabled { opacity: 0.5; cursor: not-allowed; }
    #chat-send:hover:not(:disabled) { opacity: 0.85; }

    /* ── Floating Chat Button ───────────────────────────────────────── */
    #chat-fab {
      position: fixed; bottom: 1.25rem; right: 1.25rem; z-index: 50;
      display: flex; align-items: center; gap: 0.5rem;
      background: var(--primary); color: var(--primary-fg);
      border: none; border-radius: 50px; padding: 0.75rem 1.25rem;
      font-size: 0.875rem; font-weight: 600; cursor: pointer;
      box-shadow: var(--shadow-lg); transition: transform 0.15s, opacity 0.15s;
    }
    #chat-fab:hover { transform: scale(1.04); }
    #chat-fab:active { transform: scale(0.97); }
    #chat-fab.is-open {
      background: var(--muted-bg); color: var(--fg-muted);
      border: 1px solid var(--border);
    }
    @media (max-width: 400px) { #chat-fab .fab-label { display: none; } }

    /* ── Utilities ──────────────────────────────────────────────────── */
    .hidden { display: none !important; }
    svg { display: inline-block; vertical-align: middle; }
  </style>
</head>
<body>

<!-- ═══════════════════════════════════════════════════════════════════ HEADER -->
<header>
  <div class="container">
    <div class="header-inner">
      <div class="header-profile">
        <div class="header-avatar">
          <img src="profile.jpg" alt="João Pedro Tonello" />
        </div>
        <div class="header-text">
          <div class="header-name">João Pedro Tonello</div>
          <div class="header-title">AI Engineer / Data Scientist</div>
        </div>
      </div>
      <nav class="header-nav">
        <button class="btn active" id="tab-portfolio" onclick="setTab('portfolio')">Portfolio</button>
        <button class="btn" id="tab-resume" onclick="setTab('resume')">Resume</button>
        <button class="btn btn-outline btn-ask-header" onclick="openChat()">
          <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          Ask about João
        </button>
        <button class="btn btn-ghost" id="theme-btn" onclick="toggleTheme()" aria-label="Toggle theme">
          <svg id="theme-icon-moon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <svg id="theme-icon-sun" class="hidden" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
          <span id="theme-label" class="hidden" style="display:none">Dark</span>
        </button>
      </nav>
    </div>
  </div>
</header>

<!-- ═══════════════════════════════════════════════════════════════════ MAIN -->
<main>
  <div class="container">

    <!-- ── PORTFOLIO TAB ─────────────────────────────────────────── -->
    <div id="view-portfolio">
      <!-- Hero -->
      <div class="hero">
        <div class="hero-avatar">
          <img src="profile.jpg" alt="João Pedro Tonello" />
        </div>
        <div>
          <h1>João Pedro Tonello</h1>
          <div class="hero-title">AI Engineer / Data Scientist</div>
          <div class="hero-meta">
            <span>
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
              São Paulo, Brazil
            </span>
            <a href="https://www.linkedin.com/in/joaopedrotonello/" target="_blank" rel="noopener noreferrer">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
              LinkedIn
              <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
            </a>
            <a href="mailto:joaopedro.tonellosouza@gmail.com">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
              joaopedro.tonellosouza@gmail.com
            </a>
            <a href="tel:+5513997722345">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
              +55 13 997722345
            </a>
          </div>
        </div>
      </div>

      <!-- About -->
      <div class="card about-card">
        <div class="section-title">About Me</div>
        <p>I am a Data Scientist with 8 years of experience in technology and 6 years dedicated to data, machine learning, and AI. I have a background in Automation and Robotics Engineering and have worked across large organizations such as Zurich Insurance, the National Telecommunications Institute, Mercedes-Benz, and one of Latam’s largest law firms. My background spans insurance, legal analytics, finance, risk modeling, and the development of complex AI solutions including LLM integration, end-to-end pipelines, human-in-the-loop workflows, and production monitoring.</p>
        <p>My work focuses on measurable business impact rather than model novelty. I help improve revenue capture, pricing decisions, operational efficiency, and decision quality. I’m comfortable working with both structured and unstructured data, combining techniques such as gradient boosting, probability calibration, Monte Carlo methods, embeddings, and large language models to deliver precise, robust, and governable AI systems.</p>
        <div class="badges" id="portfolio-badges"></div>
      </div>

      <!-- Projects -->
      <div class="section">
        <div class="section-title">Projects</div>
        <div id="portfolio-cards"></div>
      </div>
    </div>

    <!-- ── RESUME TAB ─────────────────────────────────────────────── -->
    <div id="view-resume" class="hidden">

      <!-- About Me -->
      <div class="card about-card" style="margin-bottom:1.75rem">
        <div class="section-title">About Me</div>
        <p>I am a Data Scientist with eight years of experience in technology and six years dedicated to data, machine learning, and AI. I have a background in Automation and Robotics Engineering and have worked across major organizations in insurance, finance, telecommunications, and legal services. My experience ranges from predictive modeling and risk analytics to the design of AI systems deployed in real workflows, including LLM-driven components when they materially improve accuracy, efficiency, or decision quality. I focus on measurable business impact rather than model novelty, combining statistical modeling, probabilistic methods, and modern AI techniques to deliver solutions that are reliable, interpretable, and aligned with real operational constraints.</p>
        <ul class="about-bullets" id="resume-highlights"></ul>
      </div>

      <!-- Key Technologies -->
      <div class="card about-card" style="margin-bottom:1.75rem">
        <div class="section-title" style="font-size:1rem">Key Technologies</div>
        <div class="badges" id="resume-badges"></div>
      </div>

      <!-- Experience -->
      <div class="section">
        <div class="section-title">Experience</div>
        <div id="resume-cards"></div>
      </div>

      <!-- Key Achievements -->
      <div class="section">
        <div class="section-title">Key Achievements</div>
        <div id="achievement-cards"></div>
      </div>

      <!-- Education -->
      <div class="card about-card">
        <div class="section-title" style="font-size:1rem">Education</div>
        <div class="edu-list" id="education-list"></div>
      </div>
    </div>

  </div>
</main>

<!-- ═══════════════════════════════════════════════════════════════════ FOOTER -->
<footer>
  <div class="container">
    <div class="footer-inner">
      <div class="footer-links">
        <a href="https://www.linkedin.com/in/joaopedrotonello/" target="_blank" rel="noopener noreferrer">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
          LinkedIn
        </a>
        <span>
          <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
          São Paulo, Brazil
        </span>
      </div>
      <p id="footer-year"></p>
    </div>
  </div>
</footer>

<!-- ═══════════════════════════════════════════════════════════════════ CHAT -->
<div id="chat-panel" class="hidden">
  <div class="chat-header">
    <div class="chat-header-info">
      <div class="chat-avatar">
        <img src="profile.jpg" alt="João" />
      </div>
      <div>
        <div class="chat-header-name">Ask about João ✨</div>
        <div class="chat-header-sub">AI-powered · answers instantly</div>
      </div>
    </div>
    <button class="chat-close" onclick="closeChat()" aria-label="Close chat">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
  </div>
  <div class="chat-messages" id="chat-messages"></div>
  <div class="chat-input-area">
    <input type="text" id="chat-input" placeholder="Ask me anything..." autocomplete="off" />
    <button id="chat-send" onclick="sendMessage()" aria-label="Send">
      <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
    </button>
  </div>
</div>

<button id="chat-fab" onclick="toggleChat()" aria-label="Ask about João">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
  <span class="fab-label">Ask about João</span>
</button>

<!-- ═══════════════════════════════════════════════════════════════════ SCRIPT -->
<script>
  // ── CONFIG ─────────────────────────────────────────────────────────────────
  // IMPORTANT: After deploying your backend to Render, replace the URL below
  // with your actual Render service URL. Example:
  // const BACKEND_URL = "https://joao-portfolio-backend.onrender.com";
  const BACKEND_URL = "https://my-portfolio-2524.onrender.com";

   // Detect if running locally or on GitHub Pages and set the correct base path for images
  const isLocalFile = window.location.protocol === 'file:';
  const isGitHubPages = window.location.hostname === 'jpedrotonello.github.io';
  // On GitHub Pages, images are at the root of the my_portfolio directory
  // So we need to use the full pathname to construct the correct path
  let BASE_PATH = '';
  if (isGitHubPages) {
    // GitHub Pages serves from /my_portfolio/, so images are at /my_portfolio/genie.png
    BASE_PATH = '/my_portfolio/';
  }
  console.log(`[Config] Environment: ${isLocalFile ? 'Local File' : (isGitHubPages ? 'GitHub Pages' : 'Other')}, BASE_PATH: "${BASE_PATH}"`);

  // ── DATA ────────────────────────────────────────────────────────────────────
  const DATA = {
  "personalInfo": {
    "name": "João Pedro Tonello",
    "title": "Senior Data Scientist — Applied AI & ML Engineering",
    "linkedin": "https://www.linkedin.com/in/joaopedrotonello/",
    "location": "São Paulo, Brazil",
    "photo": "3480-PedroTonello.jpg"
  },
  "about": {
    "title": "About Me",
    "introduction": "",
    "highlights": [
      "Advanced experience in predictive modeling, risk analytics, and statistical learning",
      "Strong expertise in feature engineering, leakage control, temporal validation, and calibration",
      "Skilled in combining structured and unstructured data using embeddings and modern NLP",
      "Specialized in applying LLMs to analytical workflows when they add measurable value",
      "Solid experience with ML operations: experiment tracking, reproducible pipelines, and governed deployments",
      "Deep knowledge of data governance, RBAC, monitoring, and auditability in regulated environments",
      "Able to design Human-in-the-Loop systems for quality control and operational reliability",
      "Pragmatic approach to AI: high-impact MVPs with technical rigor",
      "Strong ability to translate business problems into quantifiable ML objectives and KPIs",
    ],
    "keyTechnologies": [
      "Machine Learning & Statistical Modeling",
      "Deep Learning (PyTorch, TensorFlow)",
      "NLP & Text Embeddings",
      "LLM Applications",
      "Python",
      "SQL",
      "PySpark",
      "Databricks & Unity Catalog",
      "MLflow & Model Governance",
      "Azure AI Services",
      "Data Architecture & Feature Engineering",
      "Power BI & Data Visualization",
      "Cloud Infrastructure"
    ]
  },
  "portfolio": [
    {
      "title": "Claims Subrogation & Economic Prioritization with ML",
      "executiveSummary": "Architected a machine learning system to identify auto insurance claims eligible for Subrogation (recovery of costs from at-fault third parties). Adopting a pragmatic \"revenue-first\" strategy, I launched a text-based MVP to immediately stop revenue leakage, later evolving it into a multimodal system with an Economic Prioritization Layer based on calibrated probabilities.",
      "details": {
        "contextAndProblem": "Subrogation triage was a manual, bottlenecked process. Analysts spent hours reading free-text claim narratives to identify potential third-party liability such as rear-end collisions. This led to two critical failures: high operational cost due to expensive human time spent on clear \"no-fault\" cases, and revenue leakage because eligible cases were missed due to human error or fatigue. In high-volume Auto Insurance, missing even a small fraction of recoverable claims compounds to millions in annual losses.",
        "constraintsAndRisks": "The economic trade-off was central: false positives create congestion and cost for the legal team, while false negatives represent direct financial loss. The earliest predictive signal came from unstructured text in the First Notice of Loss, which was often short, subjective, noisy, and written under stress. The model needed to function strictly as a triage filter rather than a judge, since final liability determination legally requires human review.",
        "solutionAndArchitecture": "I executed a phased delivery to maximize ROI. Phase 1, the stop-the-bleeding MVP, used a text-classification model based only on the claim description. Even with limited input, it provided an immediate operational safety net by flagging high-probability cases that manual triage was missing. Phase 2 evolved into a multimodal XGBoost model combining structured data such as policy limits and vehicle type with NLP features extracted from the narrative. Phase 3 introduced the economic decision engine, the core differentiator, where I applied probability calibration such as isotonic regression to convert raw model scores into true probabilities and then computed the expected value of recovery against external legal costs, recommending pursuit only when the economics were favorable.",
        "implementation": "",
        "evaluation": "Success was defined by Financial Impact, not just F1-Score. We monitored the \"Recovery Rate\" of the flagged cohort and the \"Conversion Rate\" of the legal team (ensuring we weren't flooding them with low-value cases). Calibration plots were critical to validate the economic logic.",
        "impact": "The MVP alone recovered ~2% of eligible claims that had previously been slipping through manual triage, representing millions in annualized revenue recovery at scale. It also drastically reduced the time analysts spent on dead-end claims and enabled them to focus on complex negotiation. It shifted the department from process-based triage to value-based prioritization.",
        "keyLearnings": "Solidified a Pragmatic AI philosophy: shipping a high-impact MVP on day one is better than waiting months for a perfect model. Deepened technical expertise in Probability Calibration as a mandatory step for connecting ML outputs to financial P&L decisions (Expected Value calculation)."
      }
    },
    {
      "title": "Reputation Management – AI-Driven Moderation Appeals",
      "executiveSummary": "Engineered an intelligent system to improve the success rate of moderation appeals submitted to a major third-party consumer reputation platform, comparable to Trustpilot or Yelp. The solution progressed through four maturity stages, beginning with statistical and linguistic pattern analysis and culminating in a fine-tuned LLM integrated directly into Microsoft Teams. The final version delivered an observed uplift of roughly 50 percent in successful appeal approvals, significantly enhancing the firm’s reputation management workflow.",
      "details": {
        "contextAndProblem": "The firm faced reputational exposure from unfair or invalid consumer complaints posted on an external review platform. Analysts were responsible for drafting moderation appeals to contest these cases, but the platform’s automated acceptance criteria were opaque and highly sensitive to phrasing. Because analysts relied on intuition rather than identifiable linguistic patterns, appeal quality varied significantly, rejection rates were high, and the overall process lacked consistency and predictability.",
        "constraintsAndRisks": "The system required clear ethical boundaries: the objective was to standardize and clarify appeal language, not to exploit accidental correlations or loopholes in the platform’s automated checks. Any pattern identified needed to be linguistically and substantively justified. On the technical side, the model had to avoid overfitting to historical data because the platform’s acceptance criteria evolve over time. Strong governance was also essential, as appeals frequently include sensitive policy information and must comply with privacy requirements.",
        "solutionAndArchitecture": "The solution was built incrementally and validated at each stage, beginning with linguistic mapping of terms correlated with success or failure to create a manual guide that produced roughly a 30% initial uplift, then introducing a predictive classifier where analysts could paste a draft and receive a success probability score with highlighted reasoning, followed by using clustering methods to identify structural elements common in successful appeals and turning these into an evidence-based playbook, and finally implementing a fine-tuned LLM in Azure AI Foundry that generated standardized, high-quality drafts from raw claim facts for analysts to review.",
        "implementation": "Implementation was fully operationalized inside Microsoft Teams to minimize friction, with the backend orchestrated through Azure Logic Apps and Azure Functions, creating a seamless human-in-the-loop workflow in which the analyst remained the final decision-maker before submission.",
        "evaluation": "Evaluation tracked two primary metrics: the appeal acceptance rate and the aggregate reputation scores, with periodic retraining applied to detect concept drift as the external platform’s moderation logic evolved.",
        "impact": "The final fine-tuned LLM version delivered an observed ~50% increase in the volume and rate of accepted appeals compared to the baseline, significantly reduced analyst cognitive load and drafting time, and contributed to a sustained improvement in the company’s public reputation score, while acknowledging that this outcome reflects multiple concurrent customer-experience initiatives rather than a single causal factor.",
        "keyLearnings": "Consolidated a full-cycle applied AI engineering approach, starting with statistical exploration, progressing through predictive modeling, and culminating in fine-tuned generative AI for text generation. Strengthened the ability to integrate LLMs into corporate operational workflows in Microsoft Teams with strict governance, automation, and reliability."
      }
    },
    {
      "title": "Retail Expiry Risk Modeling via Monte Carlo Simulation",
      "executiveSummary": "Developed a stochastic model to estimate the probability of on-shelf stock expiration in retail environments without item-level batch tracking. By simulating inventory flows using Monte Carlo methods on daily sales and stock series, the system inferred the probable age of inventory. The feature became a major commercial driver, with ~70% of new enterprise clients citing the expiry risk model as a key factor for signing the contract.",
      "details": {
        "contextAndProblem": "Expiration date checking in retail was labor-intensive and inefficient, essentially a needle-in-a-haystack search. Field merchandisers spent hours checking products that were still fresh while missing the items that were actually expired. The available data, daily sales and stock counts, lacked batch-level granularity such as manufacturing or expiry dates, meaning we knew how much inventory existed but not how old it was. The goal was to direct the workforce toward high-risk SKUs by answering the question: given the history of arrivals and sales, what is the probability that a unit currently on the shelf has been there longer than its shelf-life?",
        "constraintsAndRisks": "Structural uncertainty was the central constraint: without batch tracking, we cannot know exactly which unit was sold, and assuming perfect FIFO (First-In, First-Out) is unrealistic in physical retail because shoppers pick from the back and shelves get messy. The solution also had to scale to millions of SKU-Store combinations daily, and running heavy simulations for every item represented a significant computational cost risk.",
        "solutionAndArchitecture": "I built a simulation engine from first principles to model the flow of goods. It began by inferring batch arrivals through the detection of positive inventory deltas adjusted for sales. Daily sales were then modeled using probabilistic withdrawal rather than deterministic FIFO, introducing an entropy parameter to reflect real-world shelf behavior where old and new stock mix unpredictably. Finally, a Monte Carlo engine ran approximately 1,000 simulations per SKU–store pair to produce a distribution of remaining stock age, and the resulting score represented the fraction of simulations in which expired stock was still present.",
        "implementation": "To make the system viable for production, I implemented deterministic pruning to skip simulations in trivial cases such as when total stock was lower than cumulative sales over the last set of days, which makes the expiration risk mathematically zero. I used adaptive sampling to adjust the number of Monte Carlo iterations, running more simulations when the estimated probability was near the decision threshold and fewer when the risk was clearly very high or very low. I focused on ranking rather than absolute probability precision, since the operational requirement was to identify and check the top 50 highest-risk items.",
        "evaluation": "",
        "impact": "Operational efficiency increased substantially by converting a random audit process into a risk-targeted workflow, allowing merchandisers to focus exclusively on high-probability items and dramatically increasing the number of expired goods detected per hour worked. It also created strong market differentiation by solving a long-standing blind spot in the retail industry, as the ability to predict expiration risk without batch-level data became a unique selling point that directly closed new enterprise deals.",
        "keyLearnings": "At the time, I addressed this analytical challenge with a robust and pragmatic Monte Carlo simulation. The modern approach would be to replace the simulation (approximate and computationally heavy) with a closed-form analytical solution. By modeling inventory flow as a Markov Chain with Multivariate Hypergeometric distributions, it becomes possible to compute the exact expiration probability in a single pass with O(1) complexity instead of relying on iterative simulation with O(N), delivering orders-of-magnitude improvements in scalability."
      }
    },
    {
      "title": "Genie Databricks: Talk to your data",
      "executiveSummary": "Architected and deployed a Natural Language to SQL (NL2SQL) interface integrated with Microsoft Teams, empowering Partners and the Executive Board to query financial and operational data with strict governance and audit trails. Through rigorous production tuning and knowledge curation, the NL2SQL accuracy rate improved from ~40% to ~95%.",
      "details": {
        "contextAndProblem": "The Executive Board and approximately 90 Partners relied on a small Data/Controllership team to answer complex questions regarding billable hours, legal fees, invoicing, cost allocation, clients, and active matters. Retrieving these answers required manual dashboard navigation or ad-hoc SQL writing, resulting in turnaround times ranging from hours to days.",
        "constraintsAndRisks": "The dataset contained highly sensitive information (including financial transactions and HR records). Therefore, the solution required strict Role-Based Access Control (RBAC), full auditability, and a \"human-in-the-loop\" review mechanism to mitigate the risk of incorrect responses or data leakage.",
        "solutionAndArchitecture": "I centralized the critical tables within the Lakehouse architecture, enforcing governance via Unity Catalog. The solution involved enriching the data dictionary and business rules with natural language descriptions, defining strict table relationships and maintaining a \"few-shot\" example base (Question → SQL) to enhance model reliability, and developing a Microsoft Teams bot interface with two key controls: (1) displaying the generated SQL for transparency and (2) triggering a human review loop when confidence was low or upon user request.",
        "implementation": "Hosted the webapp/bot on Microsoft Azure with seamless Teams integration. Access control was managed via Teams administration synced with Databricks data permissions, ensuring users could only query data authorized for their specific group. The human review workflow generated a ticket containing the context and the generated SQL for immediate audit and correction.",
        "evaluation": "Performance was monitored through a continuous operational feedback loop. Every reviewed request was tagged as correct/incorrect, directly feeding back into the knowledge base (refining rules, examples, and context). The accuracy metric (defined as \"approved response without significant manual correction\") surged from ~40% in the first week to ~95% after the initial tuning cycles.",
        "impact": "Substantially reduced time-to-answer for critical business queries. Increased Partner autonomy and trust in data, driven by the transparency of visible SQL and on-demand human review. Eliminated the bottleneck in the Data team, improving alignment on business rules and definitions across the firm.",
        "keyLearnings": "Solidified best practices in Data Governance, production-grade NL2SQL system design, and corporate chatbot integration with security/audit mechanisms. Deepened understanding of internal business logic by translating tacit institutional knowledge into structured operational instructions."
      },
      "image": "genie.png"
    },
    {
      "title": "Automated Data Extraction & Structuring for Fee Proposals",
      "executiveSummary": "Developed an AI-driven pipeline to extract structured data from diverse fee proposal formats (PDF, PPTX, DOCX), replacing a manual, error-prone process. The solution reduced processing time by ~80%, saving approximately 960 hours of operational work annually and creating a reliable dataset that enabled downstream predictive analytics.",
      "details": {
        "contextAndProblem": "The Marketing team received hundreds of fee proposals in varied unstructured formats. Manually logging key details (pricing model, scope, client, fees, practice areas) into spreadsheets was time-consuming (15 mins/doc) and inconsistent, leading to low data coverage. Valuable commercial data was locked in documents, inaccessible for analysis.",
        "constraintsAndRisks": "The primary risk was Data Quality rather than just privacy. Incorrect extraction or ambiguous fields could introduce \"silent errors,\" contaminating downstream reporting and decision-making. The system also had to handle Data Drift, as document layouts and language styles varied significantly over time. A robust \"Human-in-the-Loop\" (HITL) review process was mandatory.",
        "solutionAndArchitecture": "I implemented an extraction pipeline on Microsoft Azure using Azure AI Foundry. The architecture consisted of two distinct layers: (1) Extraction & Interpretation: An LLM with specialized prompt engineering ingested raw text to identify and normalize fields based on specific business rules. (2) Schema Enforcement & Validation: The LLM output was forced into a strict schema with controlled vocabularies (dropdowns) and standardized formats to ensure consistency across the dataset.",
        "implementationAndOperation": "The tool automatically populated a database row for each processed document, flagging AI-inferred values for rapid human validation. We established an iterative loop where recurring extraction errors drove updates to the prompt engineering and normalization logic.",
        "evaluation": "Success was measured by the Correction Rate (percentage of fields requiring human edit) and Time-to-Review. User corrections served as immediate feedback for the model, creating a continuous improvement cycle. We achieved 100% capture of incoming proposals without increasing headcount.",
        "impact": "Impact: Operational scalability by increasing processing volume to approximately 400 proposals per month (near 100% coverage). Efficiency gains by reducing average handling time from 15 minutes (manual entry) to 3 minutes (review only), saving about 12 minutes per document. ROI of roughly 80 hours saved per month, totaling around 960 hours (approximately 120 workdays) per year, allowing the team to focus on higher-value strategic tasks. Strategic value by creating the foundational structured dataset required to build the Conversion Propensity Model (described in a separate case study).",
        "keyLearnings": "Mastered the architecture of LLM-based structured extraction in production, including schema definition, data normalization, and the design of effective human-in-the-loop workflows for quality control. Gained substantial domain knowledge related to commercial pricing structures, proposal formats, and the operational dynamics behind these processes."
      },
      "image": "knowledge_mining.png"
    },
    {
      "title": "Proposal Conversion Propensity Model & Explainable AI",
      "executiveSummary": "Built a supervised classification model to estimate the probability of a client accepting a fee proposal. By combining structured deal data with unstructured text embeddings from scope descriptions, the model achieved an AUC of approximately 0.82. Among the Partners who adopted the tool, the observed conversion rate increased from 35% to 48%, supported by an interpretation layer designed to guide commercial negotiation without dictating decisions.",
      "details": {
        "contextAndProblem": "With the newly structured dataset of fee proposals, the Commercial team needed a data-driven way to estimate the likelihood of winning a deal during the drafting phase and to understand which factors, pricing model, scope phrasing, team composition, were most likely to influence the outcome.",
        "constraintsAndRisks": "The main risk was misinterpretation rather than statistical error. Because the model captures correlations instead of causality, users could mistakenly treat associative patterns as causal drivers of acceptance or rejection. To avoid this, the tool was positioned strictly as decision support, with users trained to interpret predictions as data-backed hypotheses rather than prescriptions. On the technical side, the system required strict control of data leakage to ensure no post-decision information contaminated the training set, and continuous monitoring for concept drift as proposal formats and writing styles evolved.",
        "solutionAndArchitecture": "I implemented a Gradient Boosting (XGBoost) classifier chosen for its strong performance on tabular data and its stability in business settings. The feature set combined structured variables, such as pricing model, client tier, and practice area, with text embeddings extracted from the proposal’s scope of work, which substantially improved predictive accuracy. An explainability layer was added using an interpretation method similar to SHAP values, allowing users to see which features pushed the probability up or down for each proposal and providing clear, actionable feedback during drafting.",
        "implementation": "The end-to-end solution was implemented in Databricks using Python. All experiments were tracked in MLflow, logging metrics, hyperparameters, and artifacts to ensure full reproducibility and transparent model lineage. The final model was registered and deployed as a REST API endpoint, enabling smooth integration with internal systems. New proposals were continuously incorporated into the dataset, supporting versioned retraining cycles and maintaining model freshness over time.",
        "evaluation": "Beyond traditional metrics such as an AUC of roughly 0.82, the evaluation emphasized generalization and real-world usefulness. Error patterns were analyzed across deal segments, such as fixed-fee versus hourly-rate proposals and across different client industries, to ensure the model did not systematically underperform on specific categories. The explainability layer was assessed qualitatively through partner feedback, focusing on whether the insights genuinely helped refine negotiation strategy rather than simply adding technical decoration.",
        "impact": "The tool became an important instrument for Partners during the proposal drafting process. Among the executives who actively adopted it, the observed proposal acceptance rate increased from 35% to 48%. This improvement, while operationally meaningful, remains observational and cannot be taken as strict causal proof, selection effects and behavioral differences among adopters may contribute to the uplift. Even with this caveat, the system materially enhanced prioritization, pricing calibration, and the firm’s overall understanding of conversion patterns, strengthening the commercial workflow in a measurable way.",
        "keyLearnings": "Consolidated the full lifecycle of a business-facing ML product, from strict leakage control during dataset construction to delivering a stable and consumable API. The most important lesson was learning to design an interpretation layer that provides practical, decision-oriented insights without overstating correlation as causality, a critical skill when deploying AI in high-stakes environments where misinterpretation can lead to costly decisions."
      }
    },
    {
      "title": "Realization Rate Prediction for Profitability Management",
      "executiveSummary": "Developed a regression model to predict the realization rate (billed revenue divided by the standard value of hours) before proposals were sent to clients. By using realization as a proxy for profitability risk, the tool allowed Partners to quantify the trade-off between winning a deal and maintaining healthy margins, bringing transparency to a decision process that was previously driven by intuition rather than measurable risk.",
      "details": {
        "contextAndProblem": "In professional services, every fee proposal requires balancing two competing goals: offering a price attractive enough to win the deal while preserving profitability. The key metric in this trade-off is the realization rate, which measures how much of the standard value of hours is effectively captured as billed revenue. The objective was to generate a quantitative forecast of this metric during proposal drafting, allowing Partners to anticipate whether a specific engagement was likely to maintain healthy margins given its estimated effort and pricing structure.",
        "constraintsAndRisks": "The biggest constraint was avoiding data leakage, because realization is determined by events that occur after the proposal is drafted, such as execution efficiency, scope changes, or renegotiations. The dataset had to be carefully filtered to include only information truly available at drafting time. There was also an interpretation risk: a low predicted realization is an estimate meant to support negotiation strategy, not a prescriptive instruction about whether to close a deal. As with the propensity model, any variable associated with low realization could simply be a marker for underlying complexity rather than a causal driver of inefficiency, requiring clear communication to prevent misguided interventions.",
        "solutionAndArchitecture": "I implemented a regression model using XGBoost, selected for its ability to capture non-linear interactions between pricing structures, client characteristics, and proposal attributes. The feature engineering approach followed the same hybrid architecture used in the Propensity Model, combining structured proposal data, such as pricing details, estimated values, and practice area, with NLP-derived signals extracted from the scope of work text, which added meaningful context and improved predictive performance.",
        "implementation": "The full solution was developed in Databricks using Python. MLflow handled experiment tracking, model versioning, and artifact management, ensuring clean lineage and reproducibility. The final model was deployed as a REST API endpoint so that predictions could be consumed directly within the proposal drafting workflow, making the model an operational tool rather than a standalone analytical exercise in a notebook.",
        "evaluation": "Evaluation focused on both generalization and temporal robustness. In addition to standard regression metrics such as RMSE and MAE, I examined performance across different proposal segments such as fixed-fee versus hourly arrangements and high-value contracts to ensure the model did not systematically underperform in specific clusters. I also identified areas of intrinsically higher uncertainty to set appropriate confidence expectations for users and to highlight scenarios where predictions should be interpreted more cautiously.",
        "impact": "The solution made an implicit trade-off explicit by presenting two complementary predictions at the moment of drafting: the probability of winning the deal and the expected realization. With both signals available, Partners could make rational and transparent decisions, such as adjusting pricing strategies, renegotiating the fee structure when a scope appeared risky, or establishing commercial guardrails for contracts likely to generate margin pressure.",
        "keyLearnings": "Solidified the ability to build operational ML products under strict leakage control, ensuring that all predictive signals reflect only information available at decision time. Strengthened the skill of defining target variables in complex temporal processes, where the outcome depends on events that unfold long after the initial prediction. Gained further experience delivering models as governed, reproducible endpoints within a corporate data environment, turning analytical workflows into reliable production-grade systems."
      }
    }
    
  ],
  "achievements": [
    {
      "title": "NL2SQL Executive Analytics Platform",
      "description": "Architected and deployed a production-grade NL2SQL system integrated with Microsoft Teams using Genie Databricks API. The initial production version launched with ~40% accuracy, which increased to ~95% through iterative tuning, human-in-the-loop feedback, and continuous knowledge curation."
    },
    {
      "title": "LLM-Based Document Information Extraction",
      "description": "Developed a scalable LLM information extraction pipeline for documents (PDF, DOCX, PPTX), reducing manual processing time by ~80%, saving ~900 hours of work annually, and enabling 100% structured data coverage for downstream analytics."
    },
    {
      "title": "AI-Driven Moderation Appeals for Reputation Management",
      "description": "Engineered a multi-stage system culminating in a fine-tuned LLM on Azure AI Foundry, integrated into Microsoft Teams, increasing successful moderation appeals on a third-party reputation platform by ~50% and standardizing high-quality responses."
    },
    {
      "title": "Subrogation Prioritization System for Auto Insurance Claims",
      "description": "Designed and deployed a calibrated ML pipeline to identify and economically prioritize subrogation opportunities, recovering ~2% of eligible claims that were previously missed by manual triage and generating millions in annualized revenue."
    }
  ],
  "education": [
    {
      "degree": "MBA in Data Science & Analytics",
      "institution": "University of São Paulo",
      "year": "2022"
    },
    {
      "degree": "B.Eng. in Instrumentation, Automation & Robotics Engineering",
      "institution": "Federal University of ABC",
      "year": "2020"
    },
    {
      "degree": "B.Sc. in Science & Technology",
      "institution": "Federal University of ABC",
      "year": "2018"
    }
  ],
  "resume": [
    {
      "title": "Sr Data Scientist / AI Engineer",
      "company": "Demarest",
      "period": "2025 - Present",
      "summary": "End-to-end planning and delivery of AI and data solutions: requirements definition, infrastructure sizing, statistical models, AI and LLM applications, CI/CD, testing, automation, standards, security, governance, cross-functional collaboration, and technical documentation.",
      "details": [
        "Led a successful NL2SQL project (natural language access to governed data), adapting to business rules and context and positively impacting the speed at which stakeholders obtain information.",
        "Designed and deployed an LLM-based pipeline to extract structured data from documents, automating data capture and saving about 70 hours per month of manual form-filling for the Marketing team that was previously done entirely by hand.",
        "Built a Judicial Recovery analysis model to estimate expected financial recovery and prioritize fee proposals with the highest economic return.",
        "Technologies: LLMs, Python, PySpark, Azure AI (Search and Services), Databricks, Genie Databricks API, NLP, machine learning, data analysis, predictive modeling."
      ]
    },
    {
      "title": "Senior Data Scientist",
      "company": "Zurich Insurance Company Ltd",
      "period": "2022 - 2025",
      "summary": "End-to-end machine learning modeling for auto insurance, including periodic re-evaluation, algorithm selection, batch scoring, homologation, deployment in partnership with technology teams, continuous monitoring, observability, and technical documentation.",
      "details": [
        "Reclame Aqui (Brazilian consumer complaint platform similar to Trustpilot): built an API, Logic App, and chatbot integrated with Microsoft Teams for moderation requests; the model increased the approval rate of moderation appeals by about 50%.",
        "Subrogation prediction: modeled auto insurance claims with highly imbalanced data to prevent significant losses, recovering about 2% of eligible subrogation cases that would otherwise have been lost due to human error.",
        "Risk segmentation: developed models for classification and segmentation of policyholders, generating high-impact insights for commercial and marketing teams.",
        "Tools and technologies: Python, Databricks, Azure (Foundry, Function App, Logic App, AI Services), Power BI, NLP, predictive modeling."
      ]
    },
    {
      "title": "Data Scientist",
      "company": "Involves",
      "period": "Jan 2022 - Aug 2022",
      "summary": "Developed predictive solutions and analyses aimed at operational optimization in retail, with focus on statistical modeling, computational performance, and data visualization.",
      "details": [
        "Product expiry prediction: built custom statistical models without off-the-shelf libraries and ran parallel probabilistic simulations for thousands of SKUs; the solution boosted marketing performance and helped double the customer base in 2 months.",
        "Point-of-sale out-of-stock detection: replaced an unsupervised approach with a supervised XGBoost model, increasing accuracy from about 30% to 70% by incorporating turnover and sales history.",
        "Operational reporting: created Power BI dashboards with accuracy, engagement, and financial impact metrics and automated data collection, expanding operational visibility for clients and internal teams.",
        "Technologies: Python, SQL, predictive modeling, Power BI, computational simulations, statistical analysis, AWS."
      ]
    }
  ]
};

  // ── THEME ────────────────────────────────────────────────────────────────────
  let isDark = localStorage.getItem('theme') === 'dark';
  function applyTheme() {
    document.body.classList.toggle('dark', isDark);
    document.getElementById('theme-icon-moon').classList.toggle('hidden', isDark);
    document.getElementById('theme-icon-sun').classList.toggle('hidden', !isDark);
  }
  function toggleTheme() { isDark = !isDark; localStorage.setItem('theme', isDark ? 'dark' : 'light'); applyTheme(); }
  applyTheme();

  // ── TABS ─────────────────────────────────────────────────────────────────────
  function setTab(tab) {
    document.getElementById('view-portfolio').classList.toggle('hidden', tab !== 'portfolio');
    document.getElementById('view-resume').classList.toggle('hidden', tab !== 'resume');
    document.getElementById('tab-portfolio').classList.toggle('active', tab === 'portfolio');
    document.getElementById('tab-resume').classList.toggle('active', tab === 'resume');
  }

  // ── DROPDOWN ─────────────────────────────────────────────────────────────────
  function makeDropdown(triggerHTML, bodyHTML) {
    const div = document.createElement('div');
    div.className = 'card dropdown-card';
    const btn = document.createElement('button');
    btn.className = 'dropdown-trigger';
    btn.innerHTML = triggerHTML + `<svg class="dropdown-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>`;
    const body = document.createElement('div');
    body.className = 'dropdown-body';
    body.innerHTML = bodyHTML;
    btn.onclick = () => {
      const open = body.classList.toggle('open');
      btn.querySelector('.dropdown-chevron').classList.toggle('open', open);
    };
    div.appendChild(btn); div.appendChild(body);
    return div;
  }

  function detailSection(label, text) {
    if (!text) return '';
    return `<div class="detail-section"><div class="detail-label">${label}</div><div class="detail-text">${text}</div></div>`;
  }

  // ── RENDER ───────────────────────────────────────────────────────────────────
  function render() {
    const { about, portfolio, achievements, education, resume } = DATA;

    // Portfolio badges
    const pb = document.getElementById('portfolio-badges');
    about.keyTechnologies.forEach(t => { const s = document.createElement('span'); s.className = 'badge'; s.textContent = t; pb.appendChild(s); });

    // Portfolio cards
    const pc = document.getElementById('portfolio-cards');
    portfolio.forEach(item => {
      const d = item.details;
      // Full image at top of expanded body (if image exists)
      const imageBodyHTML = item.image
        ? `<div style="margin-bottom:1rem;border-radius:8px;overflow:hidden;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;background-color:var(--muted-bg)"><img src="${isLocalFile ? '' : BASE_PATH}${item.image}" alt="${item.title}" style="max-width:100%;max-height:280px;object-fit:contain;display:block" /></div>`
        : '';
      const bodyHTML = imageBodyHTML + [
        detailSection('Context & Problem', d.contextAndProblem),
        detailSection('Constraints & Risks', d.constraintsAndRisks),
        detailSection('Solution & Architecture', d.solutionAndArchitecture),
        detailSection('Implementation', d.implementation),
        detailSection('Implementation & Operation', d.implementationAndOperation),
        detailSection('Evaluation', d.evaluation),
        detailSection('Impact', d.impact),
        detailSection('Key Learnings', d.keyLearnings),
      ].join('');
      // Thumbnail shown when collapsed (if image exists)
      const thumbHTML = item.image
        ? `<div style="flex-shrink:0;display:flex;align-items:center;justify-content:center;width:64px;height:64px;border-radius:8px;border:1px solid var(--border);background-color:var(--muted-bg)"><img src="${isLocalFile ? '' : BASE_PATH}${item.image}" alt="${item.title}" style="max-width:100%;max-height:100%;object-fit:contain" /></div>`
        : '';
      const triggerHTML = `${thumbHTML}<div class="flex-1"><div class="dropdown-title">${item.title}</div><div class="dropdown-summary">${item.executiveSummary}</div></div>`;
      const card = makeDropdown(triggerHTML, bodyHTML);
      // Hide thumbnail when expanded, show when collapsed
      const btn = card.querySelector('.dropdown-trigger');
      const thumb = btn ? btn.querySelector('img') : null;
      if (thumb) {
        card.addEventListener('click', () => {
          const isOpen = card.querySelector('.dropdown-body.open');
          if (thumb) thumb.style.display = isOpen ? 'none' : 'block';
        });
      }
      pc.appendChild(card);
    });

    // Resume highlights & badges
    const rh = document.getElementById('resume-highlights');
    about.highlights.forEach(h => { const li = document.createElement('li'); li.textContent = h; rh.appendChild(li); });
    const rb = document.getElementById('resume-badges');
    about.keyTechnologies.forEach(t => { const s = document.createElement('span'); s.className = 'badge'; s.textContent = t; rb.appendChild(s); });

    // Resume cards
    const rc = document.getElementById('resume-cards');
    resume.forEach(item => {
      const bodyHTML = `<ul class="resume-details">${item.details.map(d => `<li>${d}</li>`).join('')}</ul>`;
      const triggerHTML = `<div class="flex-1"><div class="dropdown-title">${item.title}</div><div style="margin-bottom:0.375rem"><span class="resume-company">${item.company}</span><span class="resume-period">${item.period}</span></div><div class="dropdown-summary">${item.summary}</div></div>`;
      rc.appendChild(makeDropdown(triggerHTML, bodyHTML));
    });

    // Achievements
    const ac = document.getElementById('achievement-cards');
    achievements.forEach(item => {
      const triggerHTML = `<div class="flex-1"><div class="dropdown-title"><span class="achievement-star">★</span>${item.title}</div></div>`;
      const bodyHTML = `<div class="detail-text">${item.description}</div>`;
      ac.appendChild(makeDropdown(triggerHTML, bodyHTML));
    });

    // Education
    const el = document.getElementById('education-list');
    education.forEach(item => {
      el.innerHTML += `<div class="edu-item"><div><div class="edu-degree">${item.degree}</div><div class="edu-inst">${item.institution}</div></div><div class="edu-year">${item.year}</div></div>`;
    });

    // Footer year
    document.getElementById('footer-year').textContent = `© ${new Date().getFullYear()} João Pedro Tonello. All rights reserved.`;
  }

  render();

  // ── CHAT ─────────────────────────────────────────────────────────────────────
  let chatHistory = [];
  const SUGGESTED = ["What are your main AI skills?","Tell me about your best project","What's your work experience?","Why should I hire João?"];

  function openChat() { document.getElementById('chat-panel').classList.remove('hidden'); document.getElementById('chat-fab').classList.add('is-open'); document.getElementById('chat-input').focus(); }
  function closeChat() { document.getElementById('chat-panel').classList.add('hidden'); document.getElementById('chat-fab').classList.remove('is-open'); }
  function toggleChat() { document.getElementById('chat-panel').classList.contains('hidden') ? openChat() : closeChat(); }

  function appendMsg(role, html, isMarkdown = false) {
    const msgs = document.getElementById('chat-messages');
    const row = document.createElement('div');
    row.className = `chat-msg ${role}`;
    const avatar = document.createElement('div');
    avatar.className = 'chat-msg-avatar';
    if (role === 'assistant') {
      avatar.innerHTML = '<img src="profile.jpg" alt="João" />';
    } else {
      avatar.className += ' user-icon';
      avatar.innerHTML = '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>';
    }
    const bubble = document.createElement('div');
    bubble.className = `chat-bubble ${role}`;
    if (isMarkdown && typeof marked !== 'undefined') {
      bubble.innerHTML = marked.parse(html);
    } else {
      bubble.textContent = html;
    }
    row.appendChild(avatar); row.appendChild(bubble);
    msgs.appendChild(row);
    msgs.scrollTop = msgs.scrollHeight;
    return bubble;
  }

  function showSuggestions() {
    const msgs = document.getElementById('chat-messages');
    const wrap = document.createElement('div');
    wrap.id = 'chat-suggestions-wrap';
    wrap.innerHTML = '<div class="chat-suggestions-label">Try asking:</div>';
    const list = document.createElement('div');
    list.className = 'chat-suggestions';
    SUGGESTED.forEach(q => {
      const btn = document.createElement('button');
      btn.className = 'chat-suggestion';
      btn.textContent = q;
      btn.onclick = () => sendMessage(q);
      list.appendChild(btn);
    });
    wrap.appendChild(list);
    msgs.appendChild(wrap);
    msgs.scrollTop = msgs.scrollHeight;
  }

  function removeSuggestions() {
    const el = document.getElementById('chat-suggestions-wrap');
    if (el) el.remove();
  }

  // Init chat
  appendMsg('assistant', "Hi! I'm João's AI assistant — ask me anything about his experience, projects, or skills! 🚀");
  showSuggestions();

  // Auto-open on desktop
  if (window.innerWidth >= 900) {
    setTimeout(openChat, 1200);
  }

  async function sendMessage(text) {
    const input = document.getElementById('chat-input');
    const msg = text || input.value.trim();
    if (!msg) return;
    input.value = '';
    removeSuggestions();
    appendMsg('user', msg);
    chatHistory.push({ role: 'user', content: msg });

    // Loading indicator
    const msgs = document.getElementById('chat-messages');
    const loadRow = document.createElement('div');
    loadRow.className = 'chat-msg assistant';
    loadRow.id = 'chat-loading-row';
    loadRow.innerHTML = `<div class="chat-msg-avatar"><img src="profile.jpg" alt="João" /></div><div class="chat-bubble assistant"><div class="chat-loading"><span></span><span></span><span></span></div></div>`;
    msgs.appendChild(loadRow);
    msgs.scrollTop = msgs.scrollHeight;

    document.getElementById('chat-send').disabled = true;
    input.disabled = true;

    try {
      const backendUrl = BACKEND_URL.replace(/\/$/, '');
      const res = await fetch(`${backendUrl}/api/chat`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ messages: chatHistory })
      });

      loadRow.remove();

      if (!res.ok) {
        const err = await res.json().catch(() => ({ error: 'Unknown error' }));
        appendMsg('assistant', err.error || 'Sorry, something went wrong. Please try again.');
        chatHistory.pop();
      } else {
        const data = await res.json();
        const content = data.content || 'Sorry, I could not generate a response.';
        chatHistory.push({ role: 'assistant', content });
        appendMsg('assistant', content, true);
      }
    } catch (e) {
      loadRow.remove();
      appendMsg('assistant', 'Sorry, I\'m having trouble connecting right now. Please try again in a moment.');
      chatHistory.pop();
    } finally {
      document.getElementById('chat-send').disabled = false;
      input.disabled = false;
      input.focus();
    }
  }

  document.getElementById('chat-input').addEventListener('keydown', e => {
    if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
  });
</script>
</body>
</html>
